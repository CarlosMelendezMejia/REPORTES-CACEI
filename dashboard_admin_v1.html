<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Atributos de Egreso</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/4.4.0/chart.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        /* Barra superior del header con espacios para escudos */
        .header-top {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 16px;
            margin-bottom: 16px;
        }

        .logo-slot {
            width: 96px;
            height: 96px;
            border: 2px dashed rgba(255, 255, 255, 0.6);
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.08);
            display: flex;
            align-items: center;
            justify-content: center;
            color: rgba(255, 255, 255, 0.92);
            font-weight: 700;
            font-size: 0.8rem;
            letter-spacing: 0.5px;
            user-select: none;
        }

        /* Mantener centrado el bloque de textos entre los escudos */
        .header .university-info {
            flex: 1;
            text-align: center;
            margin-bottom: 10px;
        }

        .university-info {
            margin-bottom: 20px;
        }

        .university-name {
            font-size: 1.6rem;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .faculty-name {
            font-size: 1.1rem;
            opacity: 0.9;
            margin-bottom: 20px;
        }

        .course-info {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            background: rgba(255, 255, 255, 0.1);
            padding: 20px;
            border-radius: 15px;
            backdrop-filter: blur(10px);
        }

        .course-detail {
            text-align: center;
        }

        .course-label {
            font-size: 0.9rem;
            opacity: 0.8;
            margin-bottom: 5px;
        }

        .course-value {
            font-size: 1.1rem;
            font-weight: 600;
        }

        .dashboard-title {
            background: linear-gradient(90deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2rem;
            font-weight: 700;
            text-align: center;
            padding: 30px;
            margin: 0;
        }

        .summary-cards {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            padding: 20px 40px;
            margin-bottom: 20px;
        }

        .summary-card {
            background: linear-gradient(145deg, #f8f9ff 0%, #e8ecf7 100%);
            border-radius: 15px;
            padding: 25px;
            text-align: center;
            border-left: 4px solid #667eea;
            transition: transform 0.3s ease;
        }

        .summary-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.2);
        }

        .summary-value {
            font-size: 2.2rem;
            font-weight: 700;
            color: #2a5298;
            margin-bottom: 10px;
        }

        .summary-label {
            font-size: 0.95rem;
            color: #666;
            font-weight: 500;
        }

        .attributes-section {
            padding: 0 40px 40px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2a5298;
            margin-bottom: 30px;
            text-align: center;
        }

        .attributes-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .attribute-card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.08);
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .attribute-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid #f0f0f0;
        }

        .attribute-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: #2a5298;
            flex: 1;
        }

        .attribute-score {
            font-size: 1.3rem;
            font-weight: 700;
            padding: 8px 16px;
            border-radius: 20px;
            color: white;
            min-width: 60px;
            text-align: center;
        }

        .score-excellent {
            background: linear-gradient(135deg, #4CAF50, #45a049);
        }

        .score-good {
            background: linear-gradient(135deg, #2196F3, #1976D2);
        }

        .score-satisfactory {
            background: linear-gradient(135deg, #FF9800, #F57C00);
        }

        .score-needs-improvement {
            background: linear-gradient(135deg, #f44336, #d32f2f);
        }

        .chart-container {
            position: relative;
            height: 300px;
            margin-bottom: 20px;
        }

        .evaluation-section {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .evaluation-title {
            font-size: 1rem;
            font-weight: 600;
            color: #2a5298;
            margin-bottom: 15px;
        }

        .evaluation-text {
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            min-height: 120px;
            font-size: 0.95rem;
            line-height: 1.6;
            color: #555;
            resize: vertical;
            width: 100%;
            font-family: inherit;
        }

        .overall-analysis {
            background: linear-gradient(145deg, #fff 0%, #f8f9ff 100%);
            border-radius: 15px;
            padding: 30px;
            margin: 30px 40px;
            border: 1px solid rgba(102, 126, 234, 0.1);
        }

        .analysis-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #2a5298;
            margin-bottom: 20px;
            text-align: center;
        }

        .analysis-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
        }

        .analysis-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .analysis-card h4 {
            color: #2a5298;
            margin-bottom: 10px;
            font-size: 1.1rem;
        }

        .footer {
            background: #f8f9ff;
            padding: 25px 40px;
            text-align: center;
            color: #666;
            font-size: 0.9rem;
            border-top: 1px solid rgba(102, 126, 234, 0.1);
        }

    @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .container {
                margin: 0;
            }

            .header {
                padding: 20px;
            }

            .logo-slot {
                width: 72px;
                height: 72px;
                font-size: 0.75rem;
            }

            .university-name {
                font-size: 1.3rem;
            }

            .dashboard-title {
                font-size: 1.5rem;
                padding: 20px;
            }

            .summary-cards,
            .attributes-section {
                padding: 20px;
            }

            .attributes-grid {
                grid-template-columns: 1fr;
            }

            .course-info {
                grid-template-columns: 1fr;
                gap: 10px;
            }

            .attribute-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }

            .analysis-grid {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 480px) {
            .chart-container {
                height: 250px;
            }

            .summary-cards {
                grid-template-columns: 1fr;
            }

            .logo-slot {
                width: 56px;
                height: 56px;
                font-size: 0.7rem;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <div class="header">
            <div class="header-top">
                <!-- Espacio para escudo izquierdo -->
                <div class="logo-slot" id="logo-left" title="Espacio para escudo izquierdo">LOGO</div>

                <div class="university-info">
                    <h1 class="university-name">UNIVERSIDAD NACIONAL AUTÓNOMA DE MÉXICO</h1>
                    <h2 class="faculty-name">FACULTAD DE ESTUDIOS SUPERIORES ARAGÓN</h2>
                </div>

                <!-- Espacio para escudo derecho -->
                <div class="logo-slot" id="logo-right" title="Espacio para escudo derecho">LOGO</div>
            </div>
            <div class="course-info">
                <div class="course-detail">
                    <div class="course-label">Materia</div>
                    <div class="course-value">Álgebra</div>
                </div>
                <div class="course-detail">
                    <div class="course-label">Profesor</div>
                    <div class="course-value">Mario Sosa Rodríguez</div>
                </div>
                <div class="course-detail">
                    <div class="course-label">Grupo</div>
                    <div class="course-value">1111</div>
                </div>
                <div class="course-detail">
                    <div class="course-label">Período</div>
                    <div class="course-value">2026-1</div>
                </div>
            </div>
        </div>

        <h2 class="dashboard-title">DASHBOARD - EVALUACIÓN DE ATRIBUTOS DE EGRESO</h2>

        <!-- Aviso de error si no cargan las gráficas -->
        <div id="charts-error"
            style="display:none; margin: 0 40px 10px; padding: 12px 16px; border-radius: 10px; background: #ffe9e9; color: #a30000; border: 1px solid #ffb3b3; font-size: 0.95rem;">
            No se pudo cargar la librería de gráficas (Chart.js). Verifique su conexión a Internet o intente recargar la
            página. Se intentó un CDN alternativo automáticamente.
        </div>

        <div class="summary-cards">
            <div class="summary-card">
                <div class="summary-value">32</div>
                <div class="summary-label">Estudiantes Evaluados</div>
            </div>
            <div class="summary-card">
                <div class="summary-value">4</div>
                <div class="summary-label">Atributos Evaluados</div>
            </div>
            <div class="summary-card">
                <div class="summary-value">85.2%</div>
                <div class="summary-label">Promedio General</div>
            </div>
            <div class="summary-card">
                <div class="summary-value">94%</div>
                <div class="summary-label">Nivel Satisfactorio</div>
            </div>
        </div>

        <div class="attributes-section">
            <h3 class="section-title">Resultados por Atributo de Egreso</h3>

            <div class="attributes-grid">
                <!-- Atributo 1 -->
                <div class="attribute-card">
                    <div class="attribute-header">
                        <h4 class="attribute-title">AE1: Aplicar conocimientos matemáticos para resolver problemas de
                            ingeniería</h4>
                        <div class="attribute-score score-excellent">87%</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart1"></canvas>
                    </div>
                    <div class="evaluation-section">
                        <h5 class="evaluation-title">Evaluación Cualitativa</h5>
                        <textarea class="evaluation-text"
                            placeholder="Los estudiantes demuestran un dominio sólido en la aplicación de conceptos algebraicos fundamentales. Se observa una mejora significativa en la resolución de ecuaciones lineales y sistemas de ecuaciones. Las principales fortalezas incluyen el manejo de operaciones con números reales y la manipulación de expresiones algebraicas...">Los estudiantes demuestran un dominio sólido en la aplicación de conceptos algebraicos fundamentales. Se observa una mejora significativa en la resolución de ecuaciones lineales y sistemas de ecuaciones. Las principales fortalezas incluyen el manejo de operaciones con números reales y la manipulación de expresiones algebraicas.</textarea>
                    </div>
                </div>

                <!-- Atributo 2 -->
                <div class="attribute-card">
                    <div class="attribute-header">
                        <h4 class="attribute-title">AE3: Comunicar efectivamente ideas y resultados técnicos</h4>
                        <div class="attribute-score score-good">82%</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart2"></canvas>
                    </div>
                    <div class="evaluation-section">
                        <h5 class="evaluation-title">Evaluación Cualitativa</h5>
                        <textarea class="evaluation-text"
                            placeholder="La comunicación de procedimientos algebraicos muestra avances notables...">La comunicación de procedimientos algebraicos muestra avances notables. Los estudiantes han mejorado en la explicación de sus procesos de resolución, aunque se requiere mayor trabajo en la justificación de pasos intermedios y el uso de lenguaje matemático preciso.</textarea>
                    </div>
                </div>

                <!-- Atributo 3 -->
                <div class="attribute-card">
                    <div class="attribute-header">
                        <h4 class="attribute-title">AE5: Identificar, formular y resolver problemas de ingeniería</h4>
                        <div class="attribute-score score-excellent">89%</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart3"></canvas>
                    </div>
                    <div class="evaluation-section">
                        <h5 class="evaluation-title">Evaluación Cualitativa</h5>
                        <textarea class="evaluation-text"
                            placeholder="Excelente capacidad para identificar variables y plantear ecuaciones...">Excelente capacidad para identificar variables y plantear ecuaciones a partir de problemas contextualizados. Los estudiantes muestran habilidades destacadas para traducir situaciones del mundo real a modelos algebraicos y encontrar soluciones apropiadas.</textarea>
                    </div>
                </div>

                <!-- Atributo 4 -->
                <div class="attribute-card">
                    <div class="attribute-header">
                        <h4 class="attribute-title">AE7: Aprender de forma continua y autónoma</h4>
                        <div class="attribute-score score-satisfactory">78%</div>
                    </div>
                    <div class="chart-container">
                        <canvas id="chart4"></canvas>
                    </div>
                    <div class="evaluation-section">
                        <h5 class="evaluation-title">Evaluación Cualitativa</h5>
                        <textarea class="evaluation-text"
                            placeholder="Se observa una actitud positiva hacia el autoaprendizaje...">Se observa una actitud positiva hacia el autoaprendizaje, especialmente en la búsqueda de métodos alternativos de resolución. Sin embargo, es necesario fortalecer las estrategias de estudio independiente y la autoregulación del aprendizaje.</textarea>
                    </div>
                </div>
            </div>
        </div>

        <div class="overall-analysis">
            <h3 class="analysis-title">Análisis General y Recomendaciones</h3>
            <div class="analysis-grid">
                <div class="analysis-card">
                    <h4>Fortalezas Identificadas</h4>
                    <textarea class="evaluation-text" style="min-height: 100px;" placeholder="• Sólido dominio de operaciones algebraicas básicas
• Excelente capacidad para resolver sistemas de ecuaciones
• Mejora significativa en la modelización de problemas...">• Sólido dominio de operaciones algebraicas básicas
• Excelente capacidad para resolver sistemas de ecuaciones  
• Mejora significativa en la modelización de problemas
• Buen nivel de participación en actividades grupales</textarea>
                </div>
                <div class="analysis-card">
                    <h4>Áreas de Mejora</h4>
                    <textarea class="evaluation-text" style="min-height: 100px;" placeholder="• Fortalecer habilidades de comunicación matemática
• Desarrollar mayor autonomía en el aprendizaje
• Mejorar la justificación de procedimientos...">• Fortalecer habilidades de comunicación matemática
• Desarrollar mayor autonomía en el aprendizaje  
• Mejorar la justificación de procedimientos
• Incrementar el uso de recursos digitales para el autoaprendizaje</textarea>
                </div>
                <div class="analysis-card">
                    <h4>Estrategias de Mejora</h4>
                    <textarea class="evaluation-text" style="min-height: 100px;" placeholder="• Implementar actividades de escritura matemática
• Fomentar el trabajo colaborativo y la explicación entre pares
• Proporcionar recursos adicionales para el estudio autónomo...">• Implementar actividades de escritura matemática
• Fomentar el trabajo colaborativo y la explicación entre pares
• Proporcionar recursos adicionales para el estudio autónomo
• Diseñar rúbricas específicas para cada atributo</textarea>
                </div>
                <div class="analysis-card">
                    <h4>Seguimiento y Monitoreo</h4>
                    <textarea class="evaluation-text" style="min-height: 100px;" placeholder="• Evaluaciones periódicas por atributo
• Retroalimentación continua a estudiantes
• Ajustes en metodología según resultados...">• Evaluaciones periódicas por atributo
• Retroalimentación continua a estudiantes  
• Ajustes en metodología según resultados
• Coordinación con otras materias del plan de estudios</textarea>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>Dashboard generado automáticamente el <strong id="fecha"></strong></p>
            <p>Sistema de Evaluación de Atributos de Egreso - UNAM FES Aragón</p>
        </div>
    </div>

    <script>
        // Configurar fecha
        document.getElementById('fecha').textContent = new Date().toLocaleDateString('es-MX', {
            year: 'numeric', month: 'long', day: 'numeric'
        });

        // Cargar Chart.js con fallback a un CDN alternativo, luego inicializar gráficas
        function ensureChartJs(callback) {
            if (window.Chart) {
                callback();
                return;
            }
            // Intentar cargar desde un CDN alternativo si el primero falló
            var alt = document.createElement('script');
            alt.src = 'https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js';
            alt.async = true;
            alt.onload = function () { callback(); };
            alt.onerror = function () {
                var warn = document.getElementById('charts-error');
                if (warn) warn.style.display = 'block';
            };
            document.head.appendChild(alt);
        }

        function initCharts() {
            // Configuración común para gráficas
            const chartOptions = {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: { display: true, position: 'bottom' }
                }
            };

            // Gráfica 1 - Distribución de niveles AE1 (32 estudiantes)
            if (document.getElementById('chart1')) {
                new Chart(document.getElementById('chart1'), {
                    type: 'doughnut',
                    data: {
                        labels: ['Excelente (90-100%)', 'Bueno (80-89%)', 'Satisfactorio (70-79%)', 'Requiere Mejora (<70%)'],
                        datasets: [{
                            label: 'Estudiantes',
                            data: [14, 12, 4, 2],
                            backgroundColor: ['#4CAF50', '#2196F3', '#FF9800', '#f44336'],
                            borderWidth: 2,
                            borderColor: '#fff'
                        }]
                    },
                    options: {
                        ...chartOptions,
                        plugins: {
                            ...chartOptions.plugins,
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                        const percentage = Math.round((context.parsed / total) * 100);
                                        return context.label + ': ' + context.parsed + ' estudiantes (' + percentage + '%)';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Gráfica 2 - Progreso temporal AE3 (4 evaluaciones durante el semestre)
            if (document.getElementById('chart2')) {
                new Chart(document.getElementById('chart2'), {
                    type: 'line',
                    data: {
                        labels: ['Sep - Diagnóstica', 'Oct - Parcial 1', 'Nov - Parcial 2', 'Dic - Final'],
                        datasets: [{
                            label: 'Promedio Grupal (%)',
                            data: [68, 74, 79, 82],
                            borderColor: '#2196F3',
                            backgroundColor: 'rgba(33, 150, 243, 0.1)',
                            fill: true,
                            tension: 0.4,
                            pointRadius: 6,
                            pointBackgroundColor: '#2196F3',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2
                        }, {
                            label: 'Meta Institucional (%)',
                            data: [75, 75, 75, 75],
                            borderColor: '#4CAF50',
                            backgroundColor: 'transparent',
                            borderDash: [5, 5],
                            fill: false,
                            pointRadius: 0
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(0,0,0,0.1)' },
                                ticks: { callback: function (value) { return value + '%'; } }
                            },
                            x: { grid: { color: 'rgba(0,0,0,0.1)' } }
                        }
                    }
                });
            }

            // Gráfica 3 - Desempeño por método de evaluación AE5
            if (document.getElementById('chart3')) {
                new Chart(document.getElementById('chart3'), {
                    type: 'bar',
                    data: {
                        labels: ['Exámenes\nEscritos', 'Proyectos\nAplicados', 'Resolución\nde Casos', 'Presentaciones\nOrales'],
                        datasets: [{
                            label: 'Promedio (%)',
                            data: [85, 92, 88, 86],
                            backgroundColor: [
                                'rgba(76, 175, 80, 0.8)',
                                'rgba(33, 150, 243, 0.8)',
                                'rgba(255, 152, 0, 0.8)',
                                'rgba(156, 39, 176, 0.8)'
                            ],
                            borderColor: [
                                '#4CAF50',
                                '#2196F3',
                                '#FF9800',
                                '#9C27B0'
                            ],
                            borderWidth: 2,
                            borderRadius: 8,
                            borderSkipped: false
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(0,0,0,0.1)' },
                                ticks: { callback: function (value) { return value + '%'; } }
                            },
                            x: {
                                grid: { display: false },
                                ticks: { maxRotation: 0 }
                            }
                        },
                        plugins: {
                            ...chartOptions.plugins,
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        return 'Promedio: ' + context.parsed.y + '%';
                                    }
                                }
                            }
                        }
                    }
                });
            }

            // Gráfica 4 - Competencias de autoaprendizaje AE7
            if (document.getElementById('chart4')) {
                new Chart(document.getElementById('chart4'), {
                    type: 'radar',
                    data: {
                        labels: [
                            'Iniciativa para\nAprender',
                            'Búsqueda de\nRecursos',
                            'Autoregulación\ndel Estudio',
                            'Reflexión sobre\nel Aprendizaje',
                            'Perseverancia\nante Dificultades',
                            'Uso de\nTecnología'
                        ],
                        datasets: [{
                            label: 'Promedio Actual (%)',
                            data: [76, 82, 71, 75, 84, 69],
                            borderColor: '#FF9800',
                            backgroundColor: 'rgba(255, 152, 0, 0.2)',
                            pointBackgroundColor: '#FF9800',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 6
                        }, {
                            label: 'Meta Esperada (%)',
                            data: [80, 80, 80, 80, 80, 80],
                            borderColor: '#4CAF50',
                            backgroundColor: 'rgba(76, 175, 80, 0.1)',
                            pointBackgroundColor: '#4CAF50',
                            pointBorderColor: '#fff',
                            pointBorderWidth: 2,
                            pointRadius: 4,
                            borderDash: [5, 5]
                        }]
                    },
                    options: {
                        ...chartOptions,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                grid: { color: 'rgba(0,0,0,0.1)' },
                                angleLines: { color: 'rgba(0,0,0,0.1)' },
                                pointLabels: {
                                    font: { size: 11 },
                                    color: '#666'
                                },
                                ticks: {
                                    display: true,
                                    stepSize: 20,
                                    callback: function (value) { return value + '%'; }
                                }
                            }
                        },
                        plugins: {
                            ...chartOptions.plugins,
                            tooltip: {
                                callbacks: {
                                    label: function (context) {
                                        return context.dataset.label + ': ' + context.parsed.r + '%';
                                    }
                                }
                            }
                        }
                    }
                });
            }
        }

        // Si la primera carga de Chart.js (CDN principal) funcionó, Chart ya existe; si no, intentamos el alterno
        if (window.Chart) {
            initCharts();
        } else {
            ensureChartJs(initCharts);
        }
    </script>
</body>

</html>